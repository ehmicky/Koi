
              
   TAR-STREAM  
              



ALTERNATIVES ==>                  #  - tar (preferred): more features. CLI only.
                                  #  - tar-stream (preferred): programmatic.
                                  #  - node-tar: much slower, more features

VERSION ==>                       #2.1.0

new pack([OPTS])                  #OPTS are ISTREAM options
PACK                              #ISTREAM for tar archive creation
                                  #Tar-encoded archive is read from it.
PACK.entry(HEADER[, STR|BUFFER]   #Add a file to the archive
 [, FUNC(ERROR)])->OSTREAM        #Content is either:
                                  #  - STR|BUFFER
                                  #  - OSTREAM:
                                  #     - for regular files, must write content
                                  #     - for symlinks, must write linkname
                                  #     - for others, must do nothing
PACK.finalize()                   #To do once all files added

new extract([OPTS])               #OPTS are OSTREAM options and also:
                                  #  - filenameEncoding STR (def: 'utf8')
EXTRACT                           #OSTREAM for tar archive extraction
                                  #Must write tar-encoded archive to it.
EXTRACT.on('entry', FUNC(HEADER,  #On each extracted file.
 ISTREAM, FUNC2(ERROR)))          #ISTREAM:
                                  #  - is the content
                                  #  - is empty for non-regular files
                                  #  - must be read or resume()
                                  #FUNC2 must be called once done:
                                  #  - only after ISTREAM.on('end')

HEADER                            #OBJ of metadata for each archived file
HEADER.name                       #STR. File path
HEADER.size                       #NUM (def: STR|BUFFER.length)
HEADER.mtime                      #DATE (def: now)
HEADER.mode                       #NUM (def: 0o755 for directories, 0o644 otherwise)
                                  #Is FSSTAT.mode, i.e. can also include file type
HEADER.type                       #STR (def: 'file' unless specified in 'mode') among 'file', 'directory', 'symlink',
                                  #'block-device', 'character-device', 'fifo', 'contiguous-file', 'pax-[global-]header', 'gnu-long[-link]-path'
HEADER.linkname                   #STR: for symlinks
HEADER.devminor|devmajor          #NUM: for block|character devices
HEADER.uid|gid                    #NUM (def: 0)
HEADER.uname|gname                #STR (def: null)
HEADER.pax                        #BOOL (def: false): use PAX format
